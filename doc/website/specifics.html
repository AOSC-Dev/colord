<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>colord - What is colord?</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link rel="stylesheet" href="style.css" type="text/css" media="screen"/>
<link rel="shortcut icon" href="favicon.ico"/>
</head>
<body>

<p>Back to the <a href="index.html">main page</a></p>

<h1>How it works:</h1>

<img src="img/architecture-plan.png" alt="[logo]"/>
<p>
<i>General architecture plan</i>
</p>
<br/>
<br/>
<br/>
<img src="img/cups-plan.png" alt="[logo]"/>
<p>
<i>CUPS query architecture plan</i>
</p>
<br/>
<br/>
<img src="img/cups-detailed-plan.png" alt="[logo]"/>
<p>
<i>Detailed CUPS integration plan</i>
</p>
<br/>
<br/>

<h2>Mapping the device to the profile</h2>

<p>
Preferences are per-user and are stored in GConf in GNOME 2-30, or GSettings in newer versions.
There is need for configuration of devices to profiles, and to store metadata about each device.
This is stored in the colord mapping database, which is
<code>/var/lib/colord/mapping.db</code> by default.
The schema is really simple, and as follows:
</p>
<pre>
CREATE TABLE mappings (id TEXT PRIMARY KEY,device TEXT,profile TEXT);
</pre>

<p>
Multiple profiles can of course be assigned to the same device.
Persistent devices and profiles can also be saved to the storage database, which is
<code>/var/lib/colord/storage.db</code> by default.
The schema is really simple, and as follows:
</p>
<pre>
CREATE TABLE devices (device_id TEXT PRIMARY KEY,device TEXT);
CREATE TABLE properties (device_id TEXT,property TEXT,value TEXT);
</pre>

<h2>Setting the system default</h2>
<p>
One user may want to set the default for all users.
We cannot reference files in <code>/home/foo/.icc/</code> when logged in
as user bar, as the user will not have access permissions, or in the
worst case, <code>/home/foo</code> may be encrypted and inaccessible even as root.
For this reason, colord copies the ICC profiles to a systemwide directory,
<code>/usr/lib/color</code> that is per-machine and accessible to all users.
</p>
<img src="img/polkit.png" alt="[logo]"/>
<p>
It is <a href="http://lists.freedesktop.org/archives/openicc/2010q2/002167.html">encouraged</a> that other CMS implementations also read ICC profiles from the per-machine
<code>/usr/lib/color</code> directory.
</p>

<h2>What the binaries do</h2>

<p>
GCM ships quite a few data files and binary files. Most users will interact with ICC files by double clicking on them, and with color management using ''System->Preferences->Color Profiles''. It's not expected that users should need to run any command line programs at all.
</p>

For interest, the different binaries are listed here.

<h3>GTK programs</h3>

<ul>
<li><code>gcm-import</code> - Helper to import an ICC file. This is normally run by the <code>gcm-import.desktop</code> file.</li>
<li><code>gcm-picker</code> - Simple program to pick a spot color using a photospectrometer.</li>
</ul>

<h3>Command line tools</h3>
<ul>
<li><code>gcm-inspect</code> - Command line tool to inspect settings and test the DBus API.</li>
<li><code>gcm-fix-profile</code> - Tries to fix a corrupted or invalid ICC profile file.</li>
<li><code>gcm-session</code> - DBus session service that is started on demand.</li>
<li><code>gcm-dump-edid</code> - Debugging program that dumps the EDID to a file.</li>
<li><code>gcm-dump-profile</code> - Debugging program that dumps all details about a profile.</li>
</ul>

<p>Back to the <a href="index.html">main page</a></p>

<p class="footer">
 Copyright <a href="mailto:richard@hughsie.com">Richard Hughes 2011</a><br/>
 <a href="http://validator.w3.org/check/referer">Optimized</a>
 for <a href="http://www.w3.org/">standards</a>.
</p>

</body>
</html>
